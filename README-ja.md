# 🎨 AviUtl2 スタイル設定エディター

Gradioで構築された現代的なWebベースのAviUtl2スタイル設定エディター。AviUtl2のインターフェーススタイル設定を直感的に編集・カスタマイズするためのツールです。

## ✨ 機能特性

### 🎯 コア機能
- **視覚的編集インターフェース**：面倒なテキスト編集を現代的なWebインターフェースに置き換え
- **リアルタイムプレビュー**：編集時にリアルタイムで設定効果をプレビュー可能
- **一括パラメータ調整**：複数の関連パラメータを同時に調整可能
- **スマート検証**：設定パラメータの形式と範囲を自動検証
- **🌐 多言語サポート**：中国語、英語、日本語インターフェースを完全サポート

### 🎨 対応設定項目

#### フォント設定 (Font)
- デフォルトフォント、コントロールフォント、エディターフォントなど
- フォントサイズとフォント名の個別設定をサポート
- 異なるインターフェース要素向けの専用フォント設定

#### カラーテーマ (Color)
- 背景色、テキスト色、境界色などの基本色
- ボタン、スライダー、プログレスバーなどのコントロール色
- レイヤー、オブジェクト、アンカーなどのプロフェッショナル要素色
- グラデーション色と透明度設定をサポート

#### レイアウト調整 (Layout)
- ウィンドウサイズ、セパレーター幅、スクロールバー寸法
- レイヤー高さ、タイムライン高さ、コントロールバー寸法
- リスト項目の高さ、マージンなどの詳細調整

#### フォーマットテンプレート (Format)
- ボトムバー表示形式のカスタマイズ
- 変数プレースホルダーによる柔軟な設定

## 🚀 クイックスタート

### システム要件
- Python 3.7+（未インストールの場合、スタートアップスクリプトがインストールをガイド）
- モダンWebブラウザ（Chrome、Firefox、Safariなど）
- インターネット接続（初期依存関係インストール用）

### 🌐 多言語サポート

このプロジェクトは3つの言語インターフェースをサポートしています：

- **中国語 (zh)** - デフォルト言語
- **English (en)** - 英語インターフェース
- **日本語 (ja)** - 日本語インターフェース

#### 異なる言語での起動

**方法1：直接コマンドライン起動**
```bash
# 中国語インターフェース
python aviutl2_style_editor.py --lang zh

# 英語インターフェース
python aviutl2_style_editor.py --lang en

# 日本語インターフェース
python aviutl2_style_editor.py --lang ja
```

**方法2：スタートアップスクリプトの使用（推奨）**

**Windowsユーザー：**
- `start_editor.bat` - インタラクティブ言語選択ランチャー
- `start_zh.bat` - 中国語版直接起動
- `start_en.bat` - 英語版直接起動
- `start_ja.bat` - 日本語版直接起動

**Linux/macOSユーザー：**
- `./start_editor.sh` - インタラクティブ言語選択ランチャー（実行権限が必要）

### 🚀 ワンクリックインストールと起動（初心者推奨）

#### Windowsユーザー（最も簡単な方法）
1. **`start_editor.bat`をダブルクリック**
2. スクリプトが自動的に：
   - ✅ Pythonがインストールされているかチェック
   - ✅ 仮想環境を作成（必要に応じて）
   - ✅ 必要な依存関係をすべてインストール
   - ✅ 言語選択を促す
   - ✅ ブラウザでエディターを起動

#### Linux/macOSユーザー
1. **スクリプト実行権限設定**（初回のみ）：
   ```bash
   chmod +x start_editor.sh
   ```

2. **スタートアップスクリプト実行**：
   ```bash
   ./start_editor.sh
   ```

3. スクリプトが自動的に：
   - ✅ Pythonがインストールされているかチェック
   - ✅ 仮想環境を作成（必要に応じて）
   - ✅ 必要な依存関係をすべてインストール
   - ✅ 言語選択を促す
   - ✅ ブラウザでエディターを起動

#### インテリジェントスタートアップスクリプトの機能

スマートスタートアップスクリプトは以下の機能を提供：

1. **🔍 環境検出**
   - Pythonインストールとバージョンチェック
   - pip可用性検証
   - プロジェクトファイル完全性検証

2. **🏠 仮想環境管理**
   - 仮想環境を自動作成
   - 仮想環境を自動アクティベーション
   - システムPython環境をクリーンに保つ

3. **📦 依存関係管理**
   - 必要なパッケージチェック（gradio）
   - 欠けている依存関係を自動インストール
   - pipを最新バージョンにアップグレード

4. **🌐 言語選択**
   - インタラクティブ言語選択（中国語/英語/日本語）
   - 言語設定を記憶
   - コマンドライン言語上書きをサポート

5. **🚨 エラーハンドリング**
   - 2言語での明確なエラーメッセージ
   - 役立つトラブルシューティング提案
   - 優雅な障害回復

### 手動インストール（上級ユーザー向け）

#### 方法1：コマンドラインインストール

1. **プロジェクトのクローン**
   ```bash
   git clone https://github.com/your-username/aviutl2_style_editor.git
   cd aviutl2_style_editor
   ```

2. **仮想環境作成**
   ```bash
   python -m venv .venv
   ```

3. **仮想環境アクティベーション**
   - **Windows**: `.venv\Scripts\activate`
   - **Linux/macOS**: `source .venv/bin/activate`

4. **依存関係インストール**
   ```bash
   pip install -r requirements.txt
   ```

5. **エディター実行**
   ```bash
   python aviutl2_style_editor.py --lang ja  # 日本語
   python aviutl2_style_editor.py --lang en  # 英語
   python aviutl2_style_editor.py --lang zh  # 中国語
   ```

6. **ブラウザを開く**
   `http://localhost:7860`にアクセスして使用開始

#### 方法2：クイック言語別起動

メインスタートアップスクリプトを一度実行後、クイックスタートスクリプトを使用可能：

- **Windows**: `start_zh.bat`, `start_en.bat`, `start_ja.bat`
- **Linux/macOS**: エイリアス作成または言語パラメータ付きメインスクリプト使用

### トラブルシューティング

#### よくある問題

**❌ "Python not found" エラー**
- https://www.python.org/downloads/ からPython 3.7+をインストール
- インストール時に"Add Python to PATH"にチェックを入れる

**❌ "Virtual environment creation failed" エラー**
- プロジェクトディレクトリの書き込み権限を確認
- 管理者としてスクリプト実行を試行（Windows）またはsudo使用（Linux）

**❌ "Dependency installation failed" エラー**
- インターネット接続を確認
- 手動で実行：`pip install gradio`
- プロキシ環境下ではpipプロキシ設定を確認

**❌ "Port already in use" エラー**
- ポート7860を使用している他のアプリケーションを閉じる
- またはPythonスクリプトのポートを変更

#### ヘルプ取得

問題が発生した場合：
1. エラーメッセージを確認（2言語で表示）
2. 提供されたトラブルシューティング提案に従う
3. スタートアップスクリプトを再実行
4. プロジェクトディレクトリの全ファイル存在を確認

## 📖 ユーザーガイド

### 基本操作フロー

1. **設定ファイルの読み込み**
   - 「style.confファイルを選択」ボタンをクリック
   - AviUtl2スタイル設定ファイルを選択
   - システムが自動的に解析して設定パラメータを読み込み

2. **設定パラメータの編集**
   - 異なるタブで各パラメータを調整
   - フォント設定：インターフェースで使用するフォントを調整
   - 色設定：カラーピッカーを使用してテーマ色を調整
   - レイアウト設定：インターフェースのサイズと間隔を調整
   - フォーマット設定：表示形式をカスタマイズ

3. **設定の保存**
   - 保存ファイル名を入力（デフォルト：style_new.conf）
   - 「設定を保存」ボタンをクリック
   - 生成された新しい設定ファイルをAviUtl2設定ディレクトリにコピー

### 設定パラメータの説明

#### フォントパラメータ形式
- **単一値**：例 `13` はフォントサイズを表す
- **フォント名**：例 `Yu Gothic UI` はフォント名を表す
- **複合パラメータ**：例 `16,Consolas` は「フォントサイズ,フォント名」を表す

#### カラーパラメータ形式
- **6桁16進数**：例 `202020` はRGBカラーを表す
- **8桁16進数**：例 `202020ff` はRGBAカラー（透明度付き）を表す
- **複数色**：例 `903838,b84848` はグラデーションカラーを表す

### 設定ファイルの場所

AviUtl2のスタイル設定ファイルは通常以下の場所にあります：
- `%ProgramData%\aviutl2\style.conf` (Windows)
- `~/Library/Application Support/aviutl2/style.conf` (macOS)
- `/usr/share/aviutl2/style.conf` (Linux)

## 📁 プロジェクト構造

```
aviutl2_style_editor/
├── aviutl2_style_editor.py    # メインプログラムファイル
├── locales/                   # 🌐 言語ファイルディレクトリ
│   ├── zh.json               # 中国語言語パック
│   ├── en.json               # 英語言語パック
│   └── ja.json               # 日本語言語パック
├── start_editor.bat          # 🚀 Windowsワンクリック起動スクリプト
├── start_zh.bat              # 🚀 中国語直接起動
├── start_en.bat              # 🚀 英語直接起動
├── start_ja.bat              # 🚀 日本語直接起動
├── start_editor.sh           # 🚀 Linux/macOS起動スクリプト
├── test_languages.py         # ✅ 多言語機能テストスクリプト
├── style-zh.conf             # サンプル設定ファイル（中国語コメント）
├── README.md                 # 📖 英語ドキュメント
├── README-zh.md              # 📖 中国語ドキュメント
├── README-ja.md              # 📖 日本語ドキュメント
├── LICENSE                   # 📜 オープンソースライセンス
└── requirements.txt          # 📦 Python依存関係リスト
```

## 🔧 スタートアップスクリプトの説明

### 🚀 スタートアップスクリプト機能
プロジェクトは便利なスタートアップスクリプトを提供し、以下のタスクを自動的に完了：
- **環境チェック**：Python環境が利用可能かどうかを自動検出
- **依存関係インストール**：必要なPythonパッケージを自動チェック・インストール
- **プログラム起動**：AviUtl2スタイル設定エディターを自動起動
- **フレンドリープロンプト**：明確なステータス情報とエラーハンドリングを提供

### 使用方法
- **Windows**：`start_editor.bat`をダブルクリックして起動
- **Linux/macOS**：`./start_editor.sh`を実行してプログラムを起動

スタートアップスクリプトはすべての複雑な環境設定を処理し、初心者ユーザーでも簡単に使用可能！

## 🔧 開発説明

### 依存関係
- **gradio**：Webインターフェースフレームワーク
- **configparser**：INI設定ファイル解析
- **pathlib**：パス処理

### コード構造
- `AviUtlStyleEditor` クラス：コアエディタークラス
- `parse_style_file()`：設定ファイル解析
- `create_gradio_interface()`：インターフェース作成
- `generate_config_content()`：設定生成

### 新しい言語サポートの追加

1. `locales/`ディレクトリに新しい言語ファイルを作成（例：`fr.json`）
2. 既存言語ファイルの形式に従ってすべてのテキストを翻訳
3. メインプログラムに新しい言語オプションを追加

### 拡張開発
プロジェクトはモジュラー設計を採用し、新しい設定パラメータタイプとインターフェースコントロールを簡単に追加可能。

## 🤝 コントリビューション

IssueとPull Requestを歓迎します！

1. このプロジェクトをFork
2. 機能ブランチを作成：`git checkout -b feature/new-feature`
3. 変更をコミット：`git commit -am 'Add new feature'`
4. ブランチをプッシュ：`git push origin feature/new-feature`
5. Pull Requestを送信

## 📄 ライセンス

このプロジェクトはMITライセンスの下でライセンスされています - [LICENSE](LICENSE)ファイルを参照

## 🙏 謝辞

- AviUtl2の作者KENに優れた動画編集ソフトウェアを提供してくれたことに感謝
- Gradioチームに優れたWebインターフェースフレームワークを提供してくれたことに感謝

## 📞 連絡先

質問や提案がある場合は、以下の方法で連絡してください：
- GitHub Issueを送信

---

**注意**：このツールはAviUtl2のスタイル設定編集のみに使用され、AviUtl2のコアプログラムファイルを変更しません。安心してご使用ください。